{"version":3,"file":"static/webpack/static/development/pages/authenticated.js.e848e5ab583bd68260ac.hot-update.js","sources":["webpack:///./pages/authenticated.js"],"sourcesContent":["import Router from \"next/router\";\nimport API_URL from \"../config/api\";\nimport UsersTable from \"../components/users_table\";\nimport AccountsTable from \"../components/accounts_table\";\nimport { Alert } from \"reactstrap\";\n\n\nexport default class Authenticated extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      token: \"\",\n      users: [],\n      loaded: false,\n      error: false,\n      errorMessage: ''\n    };\n\n    this.logout = this.logout.bind(this);\n  }\n\n  handleError = message => {\n    this.setState({\n      error: true,\n      errorMessage: message\n    })\n  };\n\n  async componentDidMount() {\n    if (localStorage.getItem('token') === null) {\n      Router.push('/', '/');\n    } else {\n      this.setState({ token: localStorage.getItem('token') });\n\n      try {\n        const res = await fetch(API_URL + '/users', {\n          headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json',\n            'Authorization': 'Bearer ' + localStorage.getItem('token')\n          }\n        });\n        const data = await res.json();\n\n        if (res.ok) {\n          this.setState({\n            users: data,\n            loaded: true\n          });\n        } else {\n          console.log(data.message);\n        }\n      } catch (e) {\n        console.log(e.message);\n      }\n    }\n  }\n\n  logout() {\n    localStorage.removeItem('token');\n    Router.push('/', '/');\n  }\n\n  onDismiss = () => {\n    this.setState({\n      error: false,\n    })\n  };\n\n  render() {\n    let tables = this.state.users.map(user => {\n      return <AccountsTable user_id={ user.id } onError={this.handleError} />\n    });\n    return (\n      <div>\n        <Alert color='danger' isOpen={this.state.error} toggle={this.onDismiss}>\n          {this.state.errorMessage}\n        </Alert>\n        <div className=\"row\">\n          <div className=\"col\">\n            {\n              this.state.users.length > 0\n              ?\n              <UsersTable users={this.state.users} />\n              :\n              <div className='text-center'>\n                <div className=\"spinner-border\" role=\"status\">\n                  <span className=\"sr-only\">Loading...</span>\n                </div>\n              </div>\n            }\n            <UsersTable users={this.state.users} />\n            <button className=\"btn btn-primary\" onClick={this.logout} style={{ marginTop: 20 }}>Cerrar sesion</button>\n          </div>\n          <div className=\"col\">\n            {\n              this.state.users.length > 0\n                ?\n                tables\n                :\n                <div className='text-center'>\n                  <div className=\"spinner-border\" role=\"status\">\n                    <span className=\"sr-only\">Loading...</span>\n                  </div>\n                </div>\n            }\n          </div>\n        </div>\n\n      </div>\n    );\n  }\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAeA;AACA;AACA;AAFA;AAIA;AACA;AApBA;AAyDA;AACA;AADA;AAGA;AACA;AA1DA;AACA;AACA;AACA;AACA;AACA;AALA;AAQA;AAXA;AAYA;AACA;;;;;;;;;;;;AASA;;;;;AACA;;;;;AAEA;AAAA;AAAA;;;AAGA;AACA;AACA;AACA;AACA;AAHA;AADA;AACA;;AADA;;AAOA;AACA;;AADA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;;;;;;;AACA;AACA;;;;;;;;;;;;;;;;;AAIA;AACA;AACA;AACA;;;AAQA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;;;;AAzGA;AACA;;;;;A","sourceRoot":""}